# 案例3：工作流 + 工具调用（OpenAPI/HTTP）

## 一、案例目标

- 使用工作流把任务拆成可解释步骤：
  - 输入 → 判断是否需要外部查询 → 调用工具 → 汇总输出
- 使用 `data/tool_openapi.yaml` 作为工具接口示例（学习用）。

---

## 二、推荐的工作流结构（思路）

1. **输入节点**：用户问题
2. **判断节点**：是否需要外部数据（如：查询订单状态/物流/库存）
3. **工具节点**：调用 OpenAPI/HTTP 获取数据
4. **汇总节点**：把工具结果转成用户可读答案（并输出依据/来源）

对照文件：`data/workflow_example.json`

---

## 三、验证方式

1. 构造“需要工具”的问题（示例）：
   - “帮我查一下订单 1001 的状态”
2. 构造“不需要工具”的问题（示例）：
   - “你们支持哪些退款方式？”
3. 检查：
   - 是否在需要时调用工具
   - 工具失败时是否有兜底与提示
   - 输出是否结构化且包含依据

---

## 四、扩展练习

1. 增加一个“参数抽取”步骤：从用户输入中抽取 `order_id`、`phone_last4` 等字段（并校验）。
2. 增加异常分支：工具返回 404 / 超时 / 权限失败时的处理。

