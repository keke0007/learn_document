+-----+-------------+           +-----+-------------+-------------+     
| id  | login_date  |           | id  | login_date  | next_2_day  |     
+-----+-------------+           +-----+-------------+-------------+     
| 1   | 2024-08-01  |           | 1   | 2024-08-01  | 2024-08-03  |     
| 1   | 2024-08-02  |           | 1   | 2024-08-02  | 2024-08-04  |     
| 1   | 2024-08-03  |           | 1   | 2024-08-03  | 2024-08-05  |     
| 1   | 2024-08-04  |           | 1   | 2024-08-04  | NULL        |     
| 1   | 2024-08-05  |           | 1   | 2024-08-05  | NULL        |     
| 2   | 2024-08-01  |           | 2   | 2024-08-01  | 2024-08-05  |     
| 2   | 2024-08-02  |           | 2   | 2024-08-02  | 2024-08-06  |     
| 2   | 2024-08-05  |           | 2   | 2024-08-05  | NULL        |     
| 2   | 2024-08-06  |           | 2   | 2024-08-06  | NULL        |     
| 3   | 2024-08-01  |           | 3   | 2024-08-01  | 2024-08-04  |     
| 3   | 2024-08-02  |           | 3   | 2024-08-02  | NULL        |     
| 3   | 2024-08-04  |           | 3   | 2024-08-04  | NULL        |     
| 4   | 2024-08-01  |           | 4   | 2024-08-01  | NULL        |     
| 5   | 2024-08-02  |           | 5   | 2024-08-02  | NULL        |     
| 5   | 2024-08-03  |           | 5   | 2024-08-03  | NULL        |     
+-----+-------------+           +-----+-------------+-------------+     



| tmp2.id  | tmp2.login_date  | tmp2.next_2_day  |
+----------+------------------+------------------+
| 1        | 2024-08-01       | 2024-08-03       |
| 1        | 2024-08-02       | 2024-08-04       |
| 1        | 2024-08-03       | 2024-08-05       |
+----------+------------------+------------------+


with tmp as (
    select
        id,login_date
    from user_login 
    group by id,login_date
) 

select
  id
from (
    select
        id,
        login_date,
        lead(login_date,2) over(partition by id order by login_date)  as next_2_day

    from tmp 
) tmp2
where date_add(login_date,2)=next_2_day
group by id
